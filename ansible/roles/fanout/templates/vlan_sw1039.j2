{% set eth_ports = ['ERR', '1/1', '1/2', '1/3', '1/4', '1/5', '1/6', '1/7', '1/8', '1/9', '1/10', '1/11', '1/12', '1/13', '1/14', '1/15', '1/16', '1/17', '1/18', '1/19', '1/20', '1/21', '1/22', '1/23', '1/24', '1/25', '1/26', '1/27', '1/28', '1/29', '1/30', '1/31/1', '1/31/2', '1/32'] %}
{% set uplink_port_id = 33 %}
{% set of_ports = [-1, 125, 127, 121, 123, 117, 119, 113, 115, 109, 111, 105, 107, 101, 103, 97, 99, 65, 67, 69, 71, 73, 75, 77, 79, 81, 83, 85, 87, 89, 91, 93, 94, 95] -%}

config t
{% for i in range(1,eth_ports|length-1) %}
{% set vlanid = (100+i)|string %}
interface ethernet {{eth_ports[i]}} switchport mode dot1q-tunnel
interface ethernet {{eth_ports[i]}} switchport access vlan {{ vlanid }}
{% endfor %}

{% for i in range(1,eth_ports|length-1) %}
{% set vlanid = (100+i)|string %}
openflow del-flows {{ 160 + i }}
openflow add-flows {{ 160 + i }} table=0,priority=101,dl_type=0x0806,in_port={{ of_ports[i] }},actions=output:{{ of_ports[uplink_port_id] }}
{% endfor %}
